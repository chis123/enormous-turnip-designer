/*!
 * spreadsheet
 * A JavaScript spreedsheet designer based on Handsontable.
 * 
 * @version v0.1.0
 * @author zhangqiang
 * @license MIT
 * 
 * Build on: "2016-11-09T08:34:24.737Z"
 * - handsontable version: 0.28.3
 * - formulajs version: 1.0.8
 * - moment version: 2.13.0
 * - numbro version: 1.8.0
 * - pikaday version: 1.4.0
 * - zeroclipboard version: 2.2.0
 */
!function e(t,n,i){function r(o,a){if(!n[o]){if(!t[o]){var u="function"==typeof require&&require;if(!a&&u)return u(o,!0);if(s)return s(o,!0);var l=new Error("Cannot find module '"+o+"'");throw l.code="MODULE_NOT_FOUND",l}var h=n[o]={exports:{}};t[o][0].call(h.exports,function(e){var n=t[o][1][e];return r(n?n:e)},h,h.exports,e,t,n,i)}return n[o].exports}for(var s="function"==typeof require&&require,o=0;o<i.length;o++)r(i[o]);return r}({1:[function(require,module,exports){"use strict";function e(){this.name="SpreadSheetError",this.message="发生了错误"}Object.defineProperty(exports,"__esModule",{value:!0}),e.prototype=new Error,e.prototype.constructor=e,e.prototype.toString=function(){return this.name+" => "+this.message},exports.SpreadSheetError=e},{}],2:[function(require,module,exports){"use strict";function e(e){return e&&e.__esModule?e:{default:e}}var t=require("./settings"),n=require("./core"),i=e(n),r=require("./polyfill"),s=e(r),o=require("./plugins/Plugin");i.default.globalSettings=t.globalSettings,i.default.defaultSettings=t.defaultSettings,i.default.version="0.1.0",i.default.plugins={Plugin:o.Plugin,registerPlugin:o.registerPlugin},window.BrickSpreadSheet=i.default,(0,s.default)(window)},{"./core":3,"./plugins/Plugin":13,"./polyfill":15,"./settings":16}],3:[function(require,module,exports){"use strict";function e(e){return e&&e.__esModule?e:{default:e}}function t(e,n){this.rootElement=e,this.getUserSettings(n),this.settings={},(0,o.extend)(this.settings,t.defaultSettings),(0,o.extend)(this.settings,this.userSettings),this.id=this.settings.id||this.getId(),this._initPlugin(),this.frame=new i.default(this,this.settings.frame),this.workbook=new s.default(this,this.settings.workbook),this._enablePlugin()}Object.defineProperty(exports,"__esModule",{value:!0});var n=require("./designer/Frame"),i=e(n),r=require("./designer/Workbook"),s=e(r),o=require("./utils/common"),a=require("./plugins/Plugin"),u=1;exports.default=t,t.prototype.getRootElement=function(){return this.rootElement},t.prototype.getUserSettings=function(e){return this.userSettings?this.userSettings:(e&&"string"==typeof e?this.userSettings=JSON.parse(e):this.userSettings=e,this.userSettings)},t.prototype.getSettings=function(){return this.settings},t.prototype.getId=function(){return this.id||t.globalSettings.idPrefix+u++ +"-"+(0,o.randomString)()},t.prototype.getExchangeData=function(){var e=arguments.length>0&&void 0!==arguments[0]&&arguments[0],t=this.workbook._getExchange(),n=this.frame._getExchange(),i={workbook:t,frame:n,id:this.getId()};return e?i:JSON.stringify(i)},t.prototype.getWorkbookInstance=function(){return this.workbook},t.prototype.getFrameInstance=function(){return this.frame},t.prototype._initPlugin=function(){var e=this;this.plugins=new Map,(0,a.getAllPlugins)().forEach(function(t){var n=new t(e);(0,a.validatePlugin)(n),e.plugins.set(n.__name__,n)})},t.prototype._enablePlugin=function(){this.plugins.forEach(function(e){e.isEnable()&&e.enable()})}},{"./designer/Frame":5,"./designer/Workbook":9,"./plugins/Plugin":13,"./utils/common":18}],4:[function(require,module,exports){"use strict";function e(e,t){if(!(e instanceof t))throw new TypeError("Cannot call a class as a function")}Object.defineProperty(exports,"__esModule",{value:!0});var t=function(){function e(e,t){for(var n=0;n<t.length;n++){var i=t[n];i.enumerable=i.enumerable||!1,i.configurable=!0,"value"in i&&(i.writable=!0),Object.defineProperty(e,i.key,i)}}return function(t,n,i){return n&&e(t.prototype,n),i&&e(t,i),t}}(),n=(require("../utils/common"),function(){function n(t,i){e(this,n),this.initialConfig=t,this.sheet=i}return t(n,[{key:"translate",value:function(){for(var e={},t=Object.getPrototypeOf(this),n=Object.getOwnPropertyNames(t),i=0;i<n.length;++i)n[i].startsWith("_trans")&&this[n[i]].call(this,e);return e}},{key:"initSheetState",value:function(){for(var e=Object.getPrototypeOf(this),t=Object.getOwnPropertyNames(e),n=0;n<t.length;++n)t[n].startsWith("_init")&&this[t[n]].call(this)}},{key:"_transCell",value:function(e){var t=this.initialConfig.cellMetas;if(t){e.cell=[];for(var n=0;n<t.length;++n)for(var i=t[n],r=0;r<i.length;++r){var s=i[r];if(s){var o={};if(o.row=s.row,o.col=s.col,s.dataType){for(var a in s.dataType)s.dataType.hasOwnProperty(a)&&(o[a]=s.dataType[a]);o.type=s.dataType.typeName,delete o.typeName}if(s.styles&&s.styles.alignments){var u=s.styles.alignments.join(" ht");o.className=o.className?o.className+=" ht"+u:"ht"+u}e.cell.push(o)}}}}},{key:"_transData",value:function(e){var t=this.initialConfig.data;t&&(e.minRows=this.sheet.initRows,e.minCols=this.sheet.initCols,e.data=t)}},{key:"_transColWidths",value:function(e){var t=this.initialConfig.colWidths;t&&(e.colWidths=t)}},{key:"_transRowHeights",value:function(e){var t=this.initialConfig.rowHeights;t&&(e.rowHeights=t)}},{key:"_transBorders",value:function(e){var t=this.initialConfig.borders;t&&(e.customBorders=t)}},{key:"_transMergeCells",value:function(e){var t=this.initialConfig.mergeCells;t&&(e.mergeCells=t)}},{key:"_initSelection",value:function(){var e=this.initialConfig.selection;e?this.sheet.select(e.row,e.col,e.endRow,e.endCol):this.sheet.select(0,0)}}]),n}());exports.default=n},{"../utils/common":18}],5:[function(require,module,exports){"use strict";function e(e){return e&&e.__esModule?e:{default:e}}function t(e,t){if(!(e instanceof t))throw new TypeError("Cannot call a class as a function")}Object.defineProperty(exports,"__esModule",{value:!0});var n=function(){function e(e,t){for(var n=0;n<t.length;n++){var i=t[n];i.enumerable=i.enumerable||!1,i.configurable=!0,"value"in i&&(i.writable=!0),Object.defineProperty(e,i.key,i)}}return function(t,n,i){return n&&e(t.prototype,n),i&&e(t,i),t}}(),i=require("./frame/ContextMenu"),r=e(i),s=function(){function e(n,i){t(this,e),this.spreadSheet=n,this.contextMenu=new r.default(n)}return n(e,[{key:"_getExchange",value:function(){}}]),e}();exports.default=s},{"./frame/ContextMenu":10}],6:[function(require,module,exports){"use strict";function e(e){return e&&e.__esModule?e:{default:e}}function t(e,t){if(!(e instanceof t))throw new TypeError("Cannot call a class as a function")}function n(e,t){if(!e)throw new ReferenceError("this hasn't been initialised - super() hasn't been called");return!t||"object"!=typeof t&&"function"!=typeof t?e:t}function i(e,t){if("function"!=typeof t&&null!==t)throw new TypeError("Super expression must either be null or a function, not "+typeof t);e.prototype=Object.create(t&&t.prototype,{constructor:{value:e,enumerable:!1,writable:!0,configurable:!0}}),t&&(Object.setPrototypeOf?Object.setPrototypeOf(e,t):e.__proto__=t)}Object.defineProperty(exports,"__esModule",{value:!0});var r=require("../utils/common.js"),s=require("./ConfigTranslator.js"),o=e(s),a=function(e){function s(e,i,a,u){t(this,s);var l={},h=new o.default(i,u),c=h.translate(),f=u.workbook.spreadSheet.getFrameInstance(),d=f.contextMenu.menuItems,p={};p.items=f.contextMenu.getMenuItems4HotTable(),p.callback=function(e){return function(t,n){if(d.has(t)){var i=d.get(t);i.handler&&i.handler.call(this,e,n.start,n.end,n)}}}(u),s._preference.contextMenu=p,(0,r.extend)(l,s._preference),(0,r.extend)(l,c),(0,r.extend)(l,a);var g=n(this,(s.__proto__||Object.getPrototypeOf(s)).call(this,e,l));return g._translator=h,g}return i(s,e),s}(Handsontable);a._preference={outsideClickDeselects:!1,rowHeaders:!0,colHeaders:!0,manualColumnResize:!0,manualRowResize:!0,className:"ssd-handsontable",xFormulas:!0,contextMenu:{}},exports.default=a},{"../utils/common.js":18,"./ConfigTranslator.js":4}],7:[function(require,module,exports){"use strict";function e(e){return e&&e.__esModule?e:{default:e}}function t(e,t){if(!(e instanceof t))throw new TypeError("Cannot call a class as a function")}function n(e,t){if(!e)throw new ReferenceError("this hasn't been initialised - super() hasn't been called");return!t||"object"!=typeof t&&"function"!=typeof t?e:t}function i(e,t){if("function"!=typeof t&&null!==t)throw new TypeError("Super expression must either be null or a function, not "+typeof t);e.prototype=Object.create(t&&t.prototype,{constructor:{value:e,enumerable:!1,writable:!0,configurable:!0}}),t&&(Object.setPrototypeOf?Object.setPrototypeOf(e,t):e.__proto__=t)}Object.defineProperty(exports,"__esModule",{value:!0});var r=function(){function e(e,t){for(var n=0;n<t.length;n++){var i=t[n];i.enumerable=i.enumerable||!1,i.configurable=!0,"value"in i&&(i.writable=!0),Object.defineProperty(e,i.key,i)}}return function(t,n,i){return n&&e(t.prototype,n),i&&e(t,i),t}}(),s=require("./views/Tabs"),o=(e(s),require("./HotTableAdaptor")),a=e(o),u=require("./SheetError"),l=require("../utils/common"),h=require("../utils/Emitter"),c=e(h),f=150,d=50,p=function(e){function s(e,i){t(this,s);var r=n(this,(s.__proto__||Object.getPrototypeOf(s)).call(this));return r.workbook=e,r.$$view=e.$$view,r.settings=i,r.sheetName=i.name,r.initRows=f,r.initCols=d,r.fx={},r._render(),r}return i(s,e),r(s,[{key:"_render",value:function(){this.$$view.appendTab(this.sheetName);var e=this.$$view._hotTables.get(this.sheetName),t=e.container,n=e.width,i=e.height;this.handsontable=new a.default(t,this.settings,{width:n,height:i,startRows:this.initRows,startCols:this.initCols,_isHotTableAdaptor:!0,_sheet:this},this),this.handsontable._translator.initSheetState(),this.$$view.hideContent(this.getName())}},{key:"getName",value:function(){return this.sheetName}},{key:"active",value:function(){this.workbook.activeSheet=this.getName(),this.$$view.activeTab(this.getName()),this.handsontable.render()}},{key:"isActive",value:function(){return this.workbook.activeSheet===this.getName()}},{key:"destroy",value:function(){}},{key:"rename",value:function(e){return this.workbook.renameSheet(this.getName(),e)}},{key:"select",value:function(e,t,n,i){n=n||e,i=i||t,this.handsontable.selectCell(e,t,n,i,!1)}},{key:"getSelection",value:function(){var e=this.handsontable.getSelected();return{row:e[0],col:e[1],endRow:e[2],endCol:e[3]}}},{key:"mergeCells",value:function e(t,n,i,r){for(var s=0,o=[],e=this.handsontable.getSettings().mergeCells,a=[t,n,t+i-1,n+r-1],h=e.length;h;--h){var c=e[h-1],f=[c.row,c.col,c.row+c.rowspan-1,c.col+c.colspan-1];if(l.Coordinate.isEqual(a,f)){s=1;break}if(l.Coordinate.isSubset(a,f)){s=2;break}l.Coordinate.isSuperset(a,f)?(o.push(h-1),s=3):l.Coordinate.intersection(a,f)&&(s=4)}if(0===s||3===s){if(3===s)for(var d=0;d<o.length;++d)e.splice(o[d],1);e=e||[],e.push({row:t,col:n,rowspan:i,colspan:r}),this.handsontable.updateSettings({mergeCells:e})}else if(2===s||4===s)throw new u.SheetError("给定的合并区域不合法: ["+t+", "+n+", "+i+", "+r+"]")}},{key:"unMergeCells",value:function(e,t,n,i){var r=this.handsontable.getSettings().mergeCells,s=[];if(r&&r.length)for(var o=0;o<r.length;++o)l.Coordinate.isSubset([r[o].row,r[o].col,r[o].row+r[o].rowspan-1,r[o].col+r[o].colspan-1],[e,t,e+n-1,t+i-1])||s.push(r[o]);this.handsontable.updateSettings({mergeCells:0!==s.length&&s})}},{key:"_getExchange",value:function(){var e=this._getDataMeta(),t=e.data,n=e.cells,i=this._getSize(),r=i.heights,s=i.widths,o=this.handsontable.getSettings().mergeCells;return{name:this.getName(),selection:this.getSelection(),data:t.length?t:[]._,rowHeights:r,colWidths:s,mergeCells:o,cellMetas:n}}},{key:"_getSize",value:function(){for(var e=this.handsontable,t=Math.max(e.countCols()-e.countEmptyCols(!0),20),n=Math.max(e.countRows()-e.countEmptyRows(!0),50),i=[],r=[],s=0;s<n;++s){var o=e.getRowHeight(s);0!==s||o||(o=24),i.push(o)}for(var a=0;a<t;++a)r.push(e.getColWidth(a));return{heights:i,widths:r}}},{key:"_getDataMeta",value:function(){for(var e=this.handsontable,t=e.countCols()-e.countEmptyCols(!0),n=e.countRows()-e.countEmptyRows(!0),i=[],r=[],s=0;s<n;++s){for(var o=[],a=[],u=0;u<t;++u){var l=e.getSourceDataAtCell(s,u),h=(e.getCellMeta(s,u),e.getDataAtCell(s,u)),c={};c.row=s,c.col=u,c.isFormula=!(!l||"="!==(l+"").charAt(0)),c.sourceValue=l,c.value=h,o.push(l),a.push(c)}i.push(o),r.push(a)}return{data:i,cells:r}}},{key:"_getBorders",value:function(){}}]),s}(c.default);exports.default=p},{"../utils/Emitter":17,"../utils/common":18,"./HotTableAdaptor":6,"./SheetError":8,"./views/Tabs":11}],8:[function(require,module,exports){"use strict";function e(e){this.name="SheetError",this.message=e}Object.defineProperty(exports,"__esModule",{value:!0}),exports.SheetError=e;var t=require("../SpreadSheetError");e.prototype=new t.SpreadSheetError,e.prototype.constructor=e},{"../SpreadSheetError":1}],9:[function(require,module,exports){"use strict";function e(e){return e&&e.__esModule?e:{default:e}}function t(e,t){if(!(e instanceof t))throw new TypeError("Cannot call a class as a function")}Object.defineProperty(exports,"__esModule",{value:!0});var n=function(){function e(e,t){var n=[],i=!0,r=!1,s=void 0;try{for(var o,a=e[Symbol.iterator]();!(i=(o=a.next()).done)&&(n.push(o.value),!t||n.length!==t);i=!0);}catch(e){r=!0,s=e}finally{try{!i&&a.return&&a.return()}finally{if(r)throw s}}return n}return function(t,n){if(Array.isArray(t))return t;if(Symbol.iterator in Object(t))return e(t,n);throw new TypeError("Invalid attempt to destructure non-iterable instance")}}(),i=function(){function e(e,t){for(var n=0;n<t.length;n++){var i=t[n];i.enumerable=i.enumerable||!1,i.configurable=!0,"value"in i&&(i.writable=!0),Object.defineProperty(e,i.key,i)}}return function(t,n,i){return n&&e(t.prototype,n),i&&e(t,i),t}}(),r=require("./views/Tabs"),s=e(r),o=require("./Sheet"),a=e(o),u=require("./SheetError"),l=require("../utils/dataStructure"),h=require("../utils/common"),c=require("../settings"),f=c.globalSettings.sheet.sheetName,d=function(){function e(n,i){var r=this;t(this,e),this.spreadSheet=n,this.sheets=new l.CaseInsensitiveMap,this.settings=i,this._initSettings(i),this.$$view=new s.default(this),i.sheets.forEach(function(e){return r.createSheet(e)});var o=this.getSheet(this.activeSheet);if(!o)throw new u.SheetError("指定的 activeSheet 不存在: "+this.activeSheet);o.active()}return i(e,[{key:"_initSettings",value:function(e){for(var t=Object.keys(e),n=0,i=t.length;n<i;++n)"sheets"!==t[n]&&(this[t[n]]=e[t[n]])}},{key:"getSettings",value:function(){return this.spreadSheet.getSettings()}},{key:"getId",value:function(){return this.id||(this.id=this.spreadSheet.getId()+c.globalSettings.idSuffix4Workbook)}},{key:"getSheet",value:function(e){return this.sheets.get(e)}},{key:"getSheets",value:function(){return this.sheets}},{key:"getSheetNames",value:function(){return this.sheets.keys()}},{key:"isSheetExist",value:function(e,t){return t?this.sheets.hasExact(e):this.sheets.has(e)}},{key:"_getAutoSheetIndex",value:function(){return this.$$autoSheetIndex||(this.$$autoSheetIndex=0),++this.$$autoSheetIndex}},{key:"_getAutoSheetName",value:function(){var e=c.globalSettings.sheet.autoPrefix+"",t=e+this._getAutoSheetIndex();return this.isSheetExist(t)?this._getAutoSheetName():t}},{key:"getActiveSheet",value:function(){return this.sheets.get(this.activeSheet)}},{key:"createSheet",value:function(e){e?this._validateSheetName(e.name):(e={},e.name=this._getAutoSheetName());var t=new a.default(this,e);return this.sheets.set(e.name,t),t}},{key:"destroySheet",value:function(e){"string"==typeof e&&(e=this.getSheet(e)),e.destroy()}},{key:"renameSheet",value:function(e,t){var n=this.getSheet(e);if(!n)throw new u.SheetError('工作表 "'+e+'" 不存在');e!==t?(this._validateSheetName(t,(0,h.upperCase)(e)===(0,h.upperCase)(t)),n.sheetName=t,this.activeSheet===e&&(this.activeSheet=t),this.getSheets().delete(e),this.getSheets().set(t,n),this.$$view.tabRename(e,t)):this.$$view.tabRenameCancel(e,t)}},{key:"_validateSheetName",value:function(e,t){if(!e)throw new u.SheetError("工作表的名称不能为空");if(f.test(e))throw new u.SheetError('工作表 "'+e+'" 包含非法字符');if(this.isSheetExist(e,t))throw new u.SheetError('工作表 "'+e+'" 已存在')}},{key:"_getExchange",value:function(){var e=[],t=!0,i=!1,r=void 0;try{for(var s,o=this.getSheets().toMap()[Symbol.iterator]();!(t=(s=o.next()).done);t=!0){var a=n(s.value,2),u=a[1];u&&e.push(u._getExchange())}}catch(e){i=!0,r=e}finally{try{!t&&o.return&&o.return()}finally{if(i)throw r}}return{activeSheet:this.activeSheet,sheets:e}}}]),e}();exports.default=d},{"../settings":16,"../utils/common":18,"../utils/dataStructure":19,"./Sheet":7,"./SheetError":8,"./views/Tabs":11}],10:[function(require,module,exports){"use strict";function e(e){this.spreadSheet=e,this.menuItems=new Map,this._init()}Object.defineProperty(exports,"__esModule",{value:!0});var t=function(){function e(e,t){var n=[],i=!0,r=!1,s=void 0;try{for(var o,a=e[Symbol.iterator]();!(i=(o=a.next()).done)&&(n.push(o.value),!t||n.length!==t);i=!0);}catch(e){r=!0,s=e}finally{try{!i&&a.return&&a.return()}finally{if(r)throw s}}return n}return function(t,n){if(Array.isArray(t))return t;if(Symbol.iterator in Object(t))return e(t,n);throw new TypeError("Invalid attempt to destructure non-iterable instance")}}(),n=require("../../utils/common");exports.default=e,e.prototype.register=function(e,t,n){this.menuItems.set(e,{config:t,handler:n})},e.prototype.getMenuItems4HotTable=function(){var e=this;return this._hotTableItems||(this._hotTableItems={},this.menuItems.forEach(function(t,n){var i=t.config;return e._hotTableItems[n]=i})),this._hotTableItems},e.prototype._init=function(){this.register("row_above",{name:"上方插入一行",disabled:function(){return!1}}),this.register("row_below",{name:"下方插入一行"}),this.register("hsep1","---------"),this.register("col_left",{name:"左侧插入一列"}),this.register("col_right",{name:"右侧插入一列"}),this.register("hsep2","---------"),this.register("remove_row",{name:"删除选中行",disabled:function(){return!1}}),this.register("remove_col",{name:"删除选中列"}),this.register("hsep3","---------");var e=function(e){var t=this.getSettings().mergeCells;if(t&&t.length)for(var i=0;i<t.length;++i){var r=t[i],s=r.row,o=r.col,a=r.rowspan,u=r.colspan;if(n.Coordinate[e]([s,o,s+a-1,o+u-1],this.getSelected()))return!1}return!0};this.register("q_merge_cells",{name:"单元格合并",disabled:function(){var n=this.getSelected(),i=t(n,4),r=i[0],s=i[1],o=i[2],a=i[3];return r===o&&s===a||!e.call(this,"isEqual")}},function(e,t,n){e.mergeCells(t.row,t.col,n.row-t.row+1,n.col-t.col+1)}),this.register("q_cancel_merge_cells",{name:"取消单元格合并",disabled:function(){return e.call(this,"isSubset")}},function(e,t,n){e.unMergeCells(t.row,t.col,n.row-t.row+1,n.col-t.col+1)})}},{"../../utils/common":18}],11:[function(require,module,exports){"use strict";function e(e){this.workbook=e,this.liItems=new i.CaseInsensitiveMap,this.sectionItems=new i.CaseInsensitiveMap,this._hotTables=new Map,this.rootElement=e.spreadSheet.getRootElement(),this.initDOM(),this.initBox(),this.render()}Object.defineProperty(exports,"__esModule",{value:!0});var t=require("../../utils/domHelper.js"),n=require("../../utils/common.js"),i=require("../../utils/dataStructure.js"),r=require("../../utils/eventHelper.js"),s=require("../../settings.js"),o=require("../../i18n"),a="current",u="ssd-tabs",l="ssd-tabs-content",h="ssd-tabs-section",c="ssd-tabs-nav",f="ssd-tabs-ul",d="ssd-tabs-li",p="ssd-tabs-fx",g=s.globalSettings.sheet.animated,v=s.globalSettings.sheet.sheetName;e.prototype.render=function(){this.rootElement.appendChild(this.TABS)},e.prototype.initDOM=function(){this.TABS=document.createElement("div"),this.CONTENT=document.createElement("div"),this.NAV=document.createElement("nav"),this.UL=document.createElement("ul"),this.TABS.classList.add(u),this.TABS.id=this.workbook.getId(),this.CONTENT.classList.add(l),this.NAV.classList.add(c),this.UL.classList.add(f),this.TABS.appendChild(this.CONTENT),this.TABS.appendChild(this.NAV),this.NAV.appendChild(this.UL),this.appendAddButton()},e.prototype.initBox=function(){var e=this.workbook.spreadSheet.getRootElement();this.width=this.workbook.width||(0,t.outerWidth)(e,!1),this.height=this.workbook.height||(0,t.outerHeight)(e,!1),this.TABS.style.width=this.width+"px",this.TABS.style.height=this.height+"px"},e.prototype.appendTab=function(e){var n=this,i=document.createElement("li");i.innerHTML='<a href="javascript:;"><span>'+e+"</span></a>",i.classList.add(d),i.setAttribute("data-sheet",e);var s=this.TABS.querySelector("."+a+"."+d);s?(0,t.insertAfter)(s,i):this.UL.appendChild(i),this.liItems.set(e,i),i.addEventListener("click",function(e){var t=this.dataset.sheet,i=n.workbook.getSheet(t);i.active(),(0,r.stopImmediatePropagation)(e)}),i.addEventListener("dblclick",function(e){n._onTabDblclick.call(n,this),(0,r.stopImmediatePropagation)(e)}),this.appendContent(e)},e.prototype.appendAddButton=function(){var e=this,t=document.createElement("li");t.innerHTML='<a href="javascript:;"><span>+</span></a>',t.classList.add(d),t.classList.add("add-tab"),this.UL.appendChild(t),t.addEventListener("click",function(t){var n=e.workbook.createSheet();n.active()})},e.prototype._onTabDblclick=function(e){var n=this,i=e.dataset.sheet,r=e.getElementsByTagName("span")[0],s=document.createElement("input");s.setAttribute("type","text"),s.value=i,s.classList.add("editorial"),s.style.width=(0,t.outerWidth)(r)+20+"px",s.addEventListener("blur",function(){var e=n._checkTabName(i,this.value);e===!0?n.workbook.renameSheet(i,this.value):(alert(e),n.tabRenameCancel(i,this.value))}),s.addEventListener("keypress",function(e){13===e.keyCode&&this.blur()}),(0,t.empty)(r),r.appendChild(s),s.select()},e.prototype._checkTabName=function(e,t){return(0,n.isEmptyValue)(t)?o.WARNS.S1:v.test(t)?o.WARNS.S2:(0,n.upperCase)(e)===(0,n.upperCase)(t)||!this.workbook.isSheetExist(t)||o.WARNS.S3},e.prototype.tabRename=function(e,n){var i=this.liItems.get(e),r=i.getElementsByTagName("span")[0];(0,t.innerHTML)(r,n),i.dataset.sheet=n,this.liItems.set(n,i);var s=this.sectionItems.get(e);s.dataset.sheet=n,this.sectionItems.delete(e),this.sectionItems.set(n,s);var o=this.workbook.getSheet(n);o.emit("afterRename",o,e,n)},e.prototype.tabRenameCancel=function(e,n){var i=this.liItems.get(e),r=i.getElementsByTagName("span")[0];(0,t.innerHTML)(r,e);var s=this.workbook.getSheet(e);s.emit("afterRenameCancel",s,e,n)},e.prototype.appendContent=function(e){var t=document.createElement("section"),n=document.createElement("div"),i=document.createElement("div");t.setAttribute("data-sheet",e),t.appendChild(n),t.appendChild(i),t.classList.add(h),g&&t.classList.add("ssd-animated-fast"),this.CONTENT.appendChild(t),this.sectionItems.set(e,t),this.appendFx(n,e),this.appendTable(i,e)},e.prototype.hideContent=function(e){var t=this.sectionItems.get(e);t.style.display="none"},e.prototype.appendFx=function(e,t){e.classList.add(p),e.classList.add(p+"-"+t)},e.prototype.appendTable=function(e,n){var i=this;this._hotTables.set(n,{container:e,width:this.width,height:function(){return i.height-(0,t.outerHeight)(i.NAV)}})},e.prototype.activeTab=function(e){var t=this.TABS.querySelector("."+a+"."+d);t&&t.classList.remove(a);var n=this.liItems.get(e);n.classList.add(a),this.activeContent(e)},e.prototype.activeContent=function(e){var t=this.sectionItems.get(e),n=this._formerActiveContent;n&&(g&&n.classList.remove("fadeIn"),n.style.display="none"),t.style.display="block",g&&t.classList.add("fadeIn"),this._formerActiveContent=t},exports.default=e},{"../../i18n":12,"../../settings.js":16,"../../utils/common.js":18,"../../utils/dataStructure.js":19,"../../utils/domHelper.js":20,"../../utils/eventHelper.js":21}],12:[function(require,module,exports){"use strict";Object.defineProperty(exports,"__esModule",{value:!0});exports.WARNS={S1:"工作表名不能为空白。",S2:"工作表名称包含无效字符: :  / ? * [ ]。",S3:"该名称已被使用，请尝试其他名称。"}},{}],13:[function(require,module,exports){"use strict";function e(e,t){if(!(e instanceof t))throw new TypeError("Cannot call a class as a function")}function t(e){if(!e.enable)throw new o.PluginError("插件必须包含启用方法：enable");if(!e.destroy)throw new o.PluginError("插件必须包含销毁方法：destroy")}function n(e,t){a.set(e,t),t.prototype.__name__=e}function i(e){var t=a.get(e);if(!t)throw new o.PluginError("插件不存在："+e);return t}function r(){return a}Object.defineProperty(exports,"__esModule",{value:!0}),exports.Plugin=void 0;var s=function(){function e(e,t){for(var n=0;n<t.length;n++){var i=t[n];i.enumerable=i.enumerable||!1,i.configurable=!0,"value"in i&&(i.writable=!0),Object.defineProperty(e,i.key,i)}}return function(t,n,i){return n&&e(t.prototype,n),i&&e(t,i),t}}();exports.validatePlugin=t,exports.registerPlugin=n,exports.getPlugin=i,exports.getAllPlugins=r;var o=require("./PluginError"),a=new Map,u=function(){function t(n){e(this,t),this.spreadsheet=n,this.enabled=!1}return s(t,[{key:"_registerMethod",value:function(e){var t=this,n=this.spreadsheet.constructor.prototype;n[e]=function(){return t[e]()}}},{key:"isEnable",value:function(){return!1}},{key:"enable",value:function(){}},{key:"destroy",value:function(){}}]),t}();exports.Plugin=u},{"./PluginError":14}],14:[function(require,module,exports){"use strict";function e(e){this.name="PluginError",this.message=e}Object.defineProperty(exports,"__esModule",{value:!0}),exports.PluginError=e;var t=require("../SpreadSheetError");e.prototype=new t.SpreadSheetError,e.prototype.constructor=e},{"../SpreadSheetError":1}],15:[function(require,module,exports){"use strict";function e(e){e.Number.isNaN||(e.Number.isNaN=function(e){return e!==e})}Object.defineProperty(exports,"__esModule",{value:!0}),exports.default=e},{}],16:[function(require,module,exports){"use strict";Object.defineProperty(exports,"__esModule",{value:!0});var e={idPrefix:"brick-ssd-",idSuffix4Workbook:"-workbook",sheet:{autoPrefix:"工作表",sheetName:/[\\/\?\*:\[\]'"]/,animated:!1}},t={workbook:{activeSheet:"工作表1",sheets:[{name:"工作表1"}]},persistent:!0};exports.globalSettings=e,exports.defaultSettings=t},{}],17:[function(require,module,exports){"use strict";function e(){}Object.defineProperty(exports,"__esModule",{value:!0}),e.prototype={on:function(e,t,n){var i=this.e||(this.e={});return(i[e]||(i[e]=[])).push({fn:t,ctx:n}),this},once:function(e,t,n){function i(){r.off(e,i),t.apply(n,arguments)}var r=this;return i._=t,this.on(e,i,n)},emit:function(e){var t=[].slice.call(arguments,1),n=((this.e||(this.e={}))[e]||[]).slice(),i=0,r=n.length;for(i;i<r;i++)n[i].fn.apply(n[i].ctx,t);return this},off:function(e,t){var n=this.e||(this.e={}),i=n[e],r=[];if(i&&t)for(var s=0,o=i.length;s<o;s++)i[s].fn!==t&&i[s].fn._!==t&&r.push(i[s]);return r.length?n[e]=r:delete n[e],this},getGlobalEmitter:function(){var t=new e;return function(){return t}}()},exports.default=e;exports.GlobalEmitter=e.prototype.getGlobalEmitter()},{}],18:[function(require,module,exports){"use strict";function e(e,n){return t(n,function(t,n){e[n]=t}),e}function t(e,t){for(var n in e)if((!e.hasOwnProperty||e.hasOwnProperty&&e.hasOwnProperty(n))&&t(e[n],n,e)===!1)break;return e}function n(){var e=arguments.length>0&&void 0!==arguments[0]&&arguments[0];return e?function(){}:o}function i(e){return e.toLocaleUpperCase()}function r(){function e(){return Math.floor(65536*(1+Math.random())).toString(16).substring(1)}return e()+e()+e()+e()}function s(e){return!(""!==e&&null!==e&&"undefined"!=typeof e)}Object.defineProperty(exports,"__esModule",{value:!0}),exports.extend=e,exports.objectEach=t,exports.emptyFunction=n,exports.upperCase=i,exports.randomString=r,exports.isEmptyValue=s;var o=function(){},a=function(e,t){return e[0]===t[0]&&e[1]===t[1]&&e[2]===t[2]&&e[3]===t[3]},u=function(e,t){var n=Math.max(e[0],t[0]),i=Math.max(e[1],t[1]),r=Math.min(e[2],t[2]),s=Math.min(e[3],t[3]);return n<=r&&i<=s&&[n,i,r,s]},l=function(e){return function(t,n){var i=u(t,n);return!!i&&a(i,"sub"===e?t:n)}};exports.Coordinate={isEqual:a,intersection:u,isSubset:l("sub"),isSuperset:l("sup")}},{}],19:[function(require,module,exports){"use strict";function e(e,t){if(!(e instanceof t))throw new TypeError("Cannot call a class as a function")}Object.defineProperty(exports,"__esModule",{value:!0}),exports.Stack=exports.CaseInsensitiveMap=void 0;var t=function(){function e(e,t){for(var n=0;n<t.length;n++){var i=t[n];i.enumerable=i.enumerable||!1,i.configurable=!0,"value"in i&&(i.writable=!0),Object.defineProperty(e,i.key,i)}}return function(t,n,i){return n&&e(t.prototype,n),i&&e(t,i),t}}(),n=require("./common.js"),i=function(){function i(t){e(this,i),this._map=new Map(t),this._keys={}}return t(i,[{key:"get",value:function(e){var t=this._keys[(0,n.upperCase)(e)];return this._map.get(t)}},{key:"set",value:function(e,t){return this._keys[(0,n.upperCase)(e)]=e,this._map.set(e,t)}},{key:"has",value:function(e){return this._keys[(0,n.upperCase)(e)]}},{key:"hasExact",value:function(e){return this._map.has(e)}},{key:"clear",value:function(){return this._keys={},this._map.clear()}},{key:"delete",value:function(e){var t=this._keys[(0,n.upperCase)(e)];return delete this._keys[(0,n.upperCase)(e)],this._map.delete(t)}},{key:"entries",value:function(){return this._map.entries()}},{key:"forEach",value:function(e,t){return this._map.forEach(e,t)}},{key:"keys",value:function(){return this._map.keys()}},{key:"values",value:function(){return this._map.values()}},{key:"toMap",value:function(){return this._map}}]),i}(),r=function(){function n(){var t=arguments.length>0&&void 0!==arguments[0]?arguments[0]:[];e(this,n),this.items=t}return t(n,[{key:"push",value:function(){var e;(e=this.items).push.apply(e,arguments)}},{key:"pop",value:function(){return this.items.pop()}},{key:"peek",value:function(){return this.isEmpty()?void 0:this.items[this.items.length-1]}},{key:"isEmpty",value:function(){return!this.size()}},{key:"size",value:function(){return this.items.length}}]),n}();exports.CaseInsensitiveMap=i,exports.Stack=r},{"./common.js":18}],20:[function(require,module,exports){"use strict";function e(e,t){if(o.test(t))e.innerHTML=t;else{var i=e.firstChild;i&&3===i.nodeType&&null===i.nextSibling?s?i.textContent=t:i.data=t:(n(e),e.appendChild(document.createTextNode(t)))}}function t(e,t){o.test(t)?e.insertAdjacentHTML("afterend",t):1===t.nodeType&&(e.nextSibling?e.parentNode.insertBefore(t,e.nextSibling):e.parentNode.appendChild(t))}function n(e){for(var t;t=e.lastChild;)e.removeChild(t)}function i(e){var t,n=!(arguments.length>1&&void 0!==arguments[1])||arguments[1],i=e.offsetHeight;return n===!1?i:(t=getComputedStyle(e),i+=parseInt(t.marginTop)+parseInt(t.marginBottom))}function r(e){var t,n=!(arguments.length>1&&void 0!==arguments[1])||arguments[1],i=e.offsetWidth;return n===!1?i:(t=getComputedStyle(e),i+=parseInt(t.marginLeft)+parseInt(t.marginRight))}Object.defineProperty(exports,"__esModule",{value:!0}),exports.innerHTML=e,exports.insertAfter=t,exports.empty=n,exports.outerHeight=i,exports.outerWidth=r;var s=!!document.createTextNode("test").textContent,o=(!!document.documentElement.classList,/(<(.*)>|&(.*);)/)},{}],21:[function(require,module,exports){"use strict";function e(e){e.isImmediatePropagationEnabled=!1,e.cancelBubble=!0}function t(e){"function"==typeof e.stopPropagation?e.stopPropagation():e.cancelBubble=!0}Object.defineProperty(exports,"__esModule",{value:!0}),exports.stopImmediatePropagation=e,exports.stopPropagation=t},{}]},{},[2]);